{"componentChunkName":"component---src-templates-content-template-js","path":"/es/part9/primeros_pasos_con_type_script","result":{"data":{"markdownRemark":{"html":"<div class=\"content\">\n<p>Después de la breve introducción a los principios fundamentales de TypeScript, ahora estamos listos para comenzar nuestro viaje para convertirnos en desarrolladores FullStack de TypeScript.\nEn lugar de brindarte una introducción completa a todos los aspectos de TypeScript, en esta parte nos centraremos en los problemas más comunes que surgen al desarrollar backends con Express o frontends de React con TypeScript.\nAdemás de las características del lenguaje, también tendremos un fuerte énfasis en las herramientas.</p>\n<h3>Configurando Typescript</h3>\n<p>Instala la compatibilidad con TypeScript en el editor de tu elección. <a href=\"https://code.visualstudio.com/\">Visual Studio Code</a> funciona de forma nativa con Typescript.</p>\n<p>Como se mencionó anteriormente, el código TypeScript no es ejecutable por sí mismo. Primero debe compilarse en JavaScript ejecutable.\nCuando TypeScript se compila en JavaScript, el código queda sujeto a borrado de tipos. Esto significa que las anotaciones de tipos, interfaces, alias de tipos y otras construcciones del sistema de tipos se eliminan del código y el resultado es JavaScript puro y listo para ejecutar.</p>\n<p>En un entorno de producción, la necesidad de compilación a menudo significa que debes configurar un \"paso de compilación\". Durante el paso de compilación, todo el código TypeScript se compila en JavaScript en una carpeta separada, y el entorno de producción luego ejecuta el código desde esa carpeta. En un entorno de desarrollo, a menudo es más útil hacer uso de la compilación en tiempo real y la recarga automática para poder ver los cambios resultantes más rápido.</p>\n<p>Comencemos a escribir nuestra primera aplicación TypeScript. Para simplificar las cosas, comencemos usando el paquete <a href=\"https://github.com/TypeStrong/ts-node\">ts-node</a> de npm . El cual compila y ejecuta el archivo TypeScript especificado inmediatamente, por lo que no es necesario un paso de compilación por separado.</p>\n<p>Puedes instalar tanto <em>ts-node</em> como el paquete oficial <em>typescript</em> a nivel global ejecutando</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">--location</span><span class=\"token operator\">=</span>global ts-node typescript</code></pre></div>\n<p>Si no puedes o no quieres instalar paquetes globales, puedes crear un proyecto npm que tenga las dependencias necesarias y ejecutar sus scripts en él.\nTambién tomaremos este enfoque.</p>\n<p>Como recordamos de la <a href=\"/es/part3\">parte 3</a>, un proyecto npm se configura ejecutando el comando <em>npm init</em> en un directorio vacío. Entonces podemos instalar las dependencias ejecutando</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev ts-node typescript</code></pre></div>\n<p>y configurando <em>scripts</em> dentro de package.json:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ..</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token property\">\"ts-node\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ts-node\"</span></span>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ..</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Ahora, dentro de este directorio, puedes usar <em>ts-node</em> ejecutando * npm run ts-node<em>. Ten en cuenta que si estás utilizando ts-node a través de package.json, todos los argumentos de la línea de comandos para el script deben tener el prefijo  *--</em>. Entonces, si deseas ejecutar file.ts con <em>ts-node</em> y opciones <em>-s</em> y <em>--someoption</em>, el comando completo es: --></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> run ts-node file.ts -- <span class=\"token parameter variable\">-s</span> <span class=\"token parameter variable\">--someoption</span></code></pre></div>\n<p>Vale la pena mencionar que TypeScript también proporciona un área de juegos en línea, donde puedes probar rápidamente el código TypeScript y ver instantáneamente el JavaScript resultante y los posibles errores de compilación. Puedes acceder al área de juegos oficial de TypeScript <a href=\"https://www.typescriptlang.org/play/index.html\">aquí</a>.</p>\n<p><strong>NB:</strong> El área de juegos puede contener diferentes reglas en tsconfig (que se presentarán más adelante) que en tu entorno local, por lo que es posible que veas advertencias diferentes en comparación con tu entorno local. El tsconfig de la zona de juegos se puede modificar a través del menú de configuración desplegable.</p>\n<h4>Una nota sobre el estilo de código</h4>\n<p>JavaScript en sí mismo es un lenguaje bastante relajado y, a menudo, las cosas se pueden hacer de múltiples formas diferentes. Por ejemplo, tenemos funciones anónimas y con nombre, podemos usar const y let o var, y podemos elegir si usar el <em>punto y coma</em> o no. Esta parte del curso se diferencia del resto por el uso de punto y coma. No es un patrón específico de TypeScript, sino una decisión de estilo de código general al crear cualquier tipo de proyecto de JavaScript. Utilizarlos o no suele estar en manos del programador, pero dado que se espera que podamos adaptar nuestros hábitos de código al código base existente, esperamos que uses punto y coma y que te adaptes a estilo del código en los ejercicios de esta parte. Esta parte también tiene otras diferencias de estilo de código en comparación con el resto del curso, por ejemplo, en las convenciones utilizadas para nombrar los directorios.</p>\n<p>Agreguemos una configuración al archivo <em>tsconfig.json</em> al proyecto con el siguiente contenido:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">\"compilerOptions\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n    <span class=\"token string-property property\">\"noImplicitAny\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>El archivo <em>tsconfig.json</em> es utilizado para definir como el compilador de Typescript debe interpretar el código, cuan estrictamente el compilador debería funcionar, que archivos revisar o ignorar, y <a href=\"https://www.typescriptlang.org/docs/handbook/tsconfig-json.html\">mucho más</a>.\nPor ahora, solo utilizaremos la opción del compilador <a href=\"https://www.typescriptlang.org/tsconfig#noImplicitAny\">noImplicitAny</a>, la cual no requiere tener tipos en todas las variables utilizadas.</p>\n<p>Comencemos creando un multiplicador simple. Se ve exactamente igual a como se haría en JavaScript.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">multiplicator</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> printText</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>printText<span class=\"token punctuation\">,</span>  a <span class=\"token operator\">*</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">multiplicator</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Multiplied numbers 2 and 4, the result is:'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Como puedes ver, este sigue siendo JavaScript básico y ordinario sin características adicionales de TS. Se compila y se ejecuta muy bien con <em>npm run ts-node -- multiplier.ts</em>, como lo haría con Node.</p>\n<p>Pero, ¿qué sucede si terminamos pasando <em>tipos</em> incorrectos de argumentos a la función multiplicator?</p>\n<p>¡Vamos a probarlo!</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">multiplicator</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> printText</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>printText<span class=\"token punctuation\">,</span>  a <span class=\"token operator\">*</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">multiplicator</span><span class=\"token punctuation\">(</span><span class=\"token string\">'how about a string?'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Multiplied a string and 4, the result is:'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Ahora, cuando ejecutamos el código, el resultado es: <em>Multiplied a string and 4, the result is: NaN</em>.</p>\n<p>¿No sería bueno si el lenguaje en sí mismo pudiera evitar que terminemos en situaciones como esta?\nAquí es donde vemos los primeros beneficios de TypeScript. Agreguemos tipos a los parámetros y veamos a dónde nos lleva.</p>\n<p>TypeScript admite de forma nativa varios tipos, incluidos <em>number</em>, <em>string</em> y <em>Array</em>. Ve la lista completa <a href=\"https://www.typescriptlang.org/docs/handbook/2/everyday-types.html\">aquí</a>. También se pueden crear tipos personalizados más complejos.</p>\n<p>Los dos primeros parámetros de nuestra función son de tipo number y el último es de tipo string, ambos tipos son <a href=\"https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#the-primitives-string-number-and-boolean\">primitivos</a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">multiplicator</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">a</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">b</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">printText</span><span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>printText<span class=\"token punctuation\">,</span>  a <span class=\"token operator\">*</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">multiplicator</span><span class=\"token punctuation\">(</span><span class=\"token string\">'how about a string?'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Multiplied a string and 4, the result is:'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Ahora el código ya no es JavaScript válido, sino TypeScript. Cuando intentamos ejecutar el código, notamos que no se compila:</p>\n<picture><img src=\"/static/362456a24c606b2a645642d550481c07/5a190/2a.png\" alt=\"salida de consola mostrando error de asignación de string a number\" srcset=\"/static/362456a24c606b2a645642d550481c07/772e8/2a.png 200w,\n/static/362456a24c606b2a645642d550481c07/e17e5/2a.png 400w,\n/static/362456a24c606b2a645642d550481c07/5a190/2a.png 800w,\n/static/362456a24c606b2a645642d550481c07/c1b63/2a.png 1200w,\n/static/362456a24c606b2a645642d550481c07/29007/2a.png 1600w,\n/static/362456a24c606b2a645642d550481c07/74e37/2a.png 1732w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Una de las mejores cosas de la compatibilidad con el editor de TypeScript es que ni siquiera es necesario que ejecutes el código para ver los problemas.\nVSCode es tan eficiente que te informa inmediatamente cuando intentas utilizar un tipo incorrecto:</p>\n<picture><img src=\"/static/7a73285e6588983383eb619b671d99f5/5a190/2.png\" alt=\"vscode mostrando el mismo error acerca de un string como number\" srcset=\"/static/7a73285e6588983383eb619b671d99f5/772e8/2.png 200w,\n/static/7a73285e6588983383eb619b671d99f5/e17e5/2.png 400w,\n/static/7a73285e6588983383eb619b671d99f5/5a190/2.png 800w,\n/static/7a73285e6588983383eb619b671d99f5/84a90/2.png 982w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<h3>Creando tus primeros tipos</h3>\n<p>Ampliemos nuestro multiplicador a una calculadora un poco más versátil que también admita sumas y divisiones. La calculadora debe aceptar tres argumentos: dos números y la operación, ya sea <em>multiplicar</em>, <em>sumar</em> o <em>dividir</em>, que le dice qué hacer con los números.</p>\n<p>En JavaScript, el código requeriría una validación adicional para asegurarse de que el último argumento sea un string. TypeScript ofrece una forma de definir tipos específicos de entradas, que describen exactamente qué tipo de entrada es aceptable. Además de eso, TypeScript también puede mostrar la información de los valores aceptados ya en el nivel de editor.</p>\n<p>Podemos crear un <em>tipo</em> usando la palabra clave nativa de TypeScript <em>type</em>. Describamos nuestro tipo <em>Operation</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">type Operation <span class=\"token operator\">=</span> <span class=\"token string\">'multiply'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'add'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'divide'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Ahora el tipo <em>Operation</em> acepta solo tres tipos de valores; exactamente los tres strings que queríamos.\nUtilizando el operador OR <em>|</em> podemos definir una variable para aceptar múltiples valores creando un <a href=\"https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#union-types\">union type</a>.\nEn este caso usamos strings exactos (que en términos técnicos se denominan <a href=\"https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#literal-types\">tipos literales de strings</a>) pero con uniones también podría hacer que el compilador acepte, por ejemplo, string y number:  <em>string | number</em>.</p>\n<p>La palabra clave <em>type</em> define un nuevo nombre para un tipo, un <a href=\"https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#type-aliases\">alias de tipo</a>. Dado que el tipo definido es una unión de tres valores posibles, es útil asignarle un alias que tenga un nombre representativo.</p>\n<p>Ahora echémosle un vistazo a nuestra calculadora:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">type Operation <span class=\"token operator\">=</span> <span class=\"token string\">'multiply'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'add'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'divide'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">calculator</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">a</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">b</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">op</span> <span class=\"token operator\">:</span> Operation</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>op <span class=\"token operator\">===</span> <span class=\"token string\">'multiply'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> a <span class=\"token operator\">*</span> b<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>op <span class=\"token operator\">===</span> <span class=\"token string\">'add'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>op <span class=\"token operator\">===</span> <span class=\"token string\">'divide'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>b <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token string\">'can\\'t divide by 0!'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> a <span class=\"token operator\">/</span> b<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Ahora, cuando pasamos el cursor sobre el tipo <em>Operation</em> en la función calculator, podemos ver inmediatamente sugerencias sobre qué hacer con él:</p>\n<picture><img src=\"/static/c9e244a81232619f2c53c09b6d4c69df/5a190/3.png\" alt=\"sugerencia de vs code con 3 tipos de operación\" srcset=\"/static/c9e244a81232619f2c53c09b6d4c69df/772e8/3.png 200w,\n/static/c9e244a81232619f2c53c09b6d4c69df/e17e5/3.png 400w,\n/static/c9e244a81232619f2c53c09b6d4c69df/5a190/3.png 800w,\n/static/c9e244a81232619f2c53c09b6d4c69df/c1b63/3.png 1200w,\n/static/c9e244a81232619f2c53c09b6d4c69df/081d5/3.png 1264w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Y si intentamos usar un valor que no está dentro del tipo <em>Operation</em>, obtenemos la conocida señal de advertencia roja e información adicional de nuestro editor:</p>\n<picture><img src=\"/static/5e90d50799e39dd55ed0339e3f56255a/5a190/4x.png\" alt=\"advertencia de vs code cuando intentamos utilizar &#x27;yolo&#x27; como Operation\" srcset=\"/static/5e90d50799e39dd55ed0339e3f56255a/772e8/4x.png 200w,\n/static/5e90d50799e39dd55ed0339e3f56255a/e17e5/4x.png 400w,\n/static/5e90d50799e39dd55ed0339e3f56255a/5a190/4x.png 800w,\n/static/5e90d50799e39dd55ed0339e3f56255a/c1b63/4x.png 1200w,\n/static/5e90d50799e39dd55ed0339e3f56255a/29007/4x.png 1600w,\n/static/5e90d50799e39dd55ed0339e3f56255a/c830c/4x.png 1754w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Esto ya es bastante bueno, pero una cosa que aún no hemos tocado es tipear el valor de retorno de una función. Por lo general, querrás saber qué devuelve una función, y sería bueno tener una garantía de que realmente devuelve lo que dice que hace. Agreguemos un valor de retorno <em>number</em> a la función calculator:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">type Operation <span class=\"token operator\">=</span> <span class=\"token string\">'multiply'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'add'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'divide'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> calculator <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a<span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">b</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">op</span><span class=\"token operator\">:</span> Operation<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token parameter\">number</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>op <span class=\"token operator\">===</span> <span class=\"token string\">'multiply'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> a <span class=\"token operator\">*</span> b<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>op <span class=\"token operator\">===</span> <span class=\"token string\">'add'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>op <span class=\"token operator\">===</span> <span class=\"token string\">'divide'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>b <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token string\">'this cannot be done'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> a <span class=\"token operator\">/</span> b<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>El compilador se queja de inmediato, porque en un caso la función devuelve un string. Hay un par de formas de arreglar esto:</p>\n<p>Podríamos extender el tipo de retorno para permitir valores string de esta forma:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> calculator <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a<span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">b</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">op</span><span class=\"token operator\">:</span> Operation<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> number <span class=\"token operator\">|</span> <span class=\"token parameter\">string</span> <span class=\"token operator\">=></span>  <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>O podríamos crear un tipo de retorno que incluya ambos tipos posibles, muy parecido a nuestro tipo Operation:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">type Result <span class=\"token operator\">=</span> string <span class=\"token operator\">|</span> number\n\n<span class=\"token keyword\">const</span> calculator <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a<span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">b</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">op</span><span class=\"token operator\">:</span> Operation<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token parameter\">Result</span> <span class=\"token operator\">=></span>  <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Pero ahora la pregunta es, ¿<em>realmente</em> está bien que la función devuelva un string?</p>\n<p>Cuando tu código puede terminar en una situación en la que algo se divide por 0, es probable que algo haya salido terriblemente mal y se debería generar un error y manejarlo desde donde se llamó a la función. Cuando decides devolver valores que no esperabas originalmente, las advertencias de TypeScript te impiden tomar decisiones apresuradas y te ayudan a mantener tu código funcionando como se esperaba.</p>\n<p>Una cosa más a considerar es que, aunque hemos definido tipos para nuestros parámetros, el JavaScript generado que se usa durante el tiempo de ejecución no contiene las verificaciones de tipos.\nEntonces, si, por ejemplo, el valor del parámetro de <em>operation</em> proviene de una interfaz externa, no hay garantía definitiva de que sea uno de los valores permitidos. Por lo tanto, es mejor incluir el manejo de errores y estar preparado para lo inesperado.\nEn este caso, cuando hay múltiples valores aceptados posibles y todos los inesperados deberían dar como resultado un error, la declaración <a href=\"https://developer.mozilla.org/es/docs/Web/JavaScript/Reference/Statements/switch\">switch...case</a> se adapta mejor que if...else en nuestro código.</p>\n<p>El código de nuestra calculadora debería verse así:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">type Operation <span class=\"token operator\">=</span> <span class=\"token string\">'multiply'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'add'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'divide'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> calculator <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a<span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">b</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">op</span><span class=\"token operator\">:</span> Operation<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token parameter\">number</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span>  <span class=\"token keyword\">switch</span><span class=\"token punctuation\">(</span>op<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'multiply'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">return</span> a <span class=\"token operator\">*</span> b<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'divide'</span><span class=\"token operator\">:</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>b <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Can\\'t divide by 0!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>      <span class=\"token keyword\">return</span> a <span class=\"token operator\">/</span> b<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'add'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Operation is not multiply, add or divide!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">calculator</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span> <span class=\"token punctuation\">,</span> <span class=\"token string\">'divide'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token operator\">:</span> unknown<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> errorMessage <span class=\"token operator\">=</span> <span class=\"token string\">'Something went wrong: '</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    errorMessage <span class=\"token operator\">+=</span> error<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>errorMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Estrechamiento de Tipos</h3>\n<p>El valor por defecto del parámetro <em>error</em> en el bloque catch es <em>unknown</em>. El tipo <a href=\"https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-0.html#new-unknown-top-type\">unknown</a> es una especie de tipo superior que fue introducido en la version 3 de TypeScript para ser la contraparte segura de <em>any</em>. Todo es asignable a <em>unknown</em>, pero <em>unknown</em> no es asignable a nada más que a si mismo y a <em>any</em> sin utilizar una aserción de tipo o un estrechamiento basado en el control de flujos. Asimismo, no se permiten operaciones en un <em>unknown</em> sin primero utilizar una aserción o un estrechamiento a un tipo especifico.</p>\n<p>Ambas posibles causas de excepción (operador incorrecto o división por cero) van a generar un objeto de <a href=\"https://developer.mozilla.org/es/docs/Web/JavaScript/Reference/Global_Objects/Error\">Error</a> con un mensaje de error, que nuestro programa le imprime al usuario.</p>\n<p>Si nuestro código fuera JavaScript, podríamos imprimir el mensaje de error tan solo referenciando al parámetro <a href=\"https://developer.mozilla.org/es/docs/Web/JavaScript/Reference/Global_Objects/Error/message\">message</a> del objeto <em>error</em> de la siguiente manera:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">calculator</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span> <span class=\"token punctuation\">,</span> <span class=\"token string\">'divide'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Something went wrong: '</span> <span class=\"token operator\">+</span> error<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>Ya que el tipo por defecto del objeto <em>error</em> en TypeScript es <em>unknown</em>, tenemos que <a href=\"https://www.typescriptlang.org/docs/handbook/2/narrowing.html\">estrechar</a> el tipo para acceder al parámetro:</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">calculator</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span> <span class=\"token punctuation\">,</span> <span class=\"token string\">'divide'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token operator\">:</span> <span class=\"token builtin\">unknown</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> errorMessage <span class=\"token operator\">=</span> <span class=\"token string\">'Something went wrong: '</span>\n  <span class=\"token comment\">// here we can not use error.message</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>    <span class=\"token comment\">// the type is narrowed and we can refer to error.message</span>\n<span class=\"gatsby-highlight-code-line\">    errorMessage <span class=\"token operator\">+=</span> error<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// here we can not use error.message</span>\n\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>errorMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Aquí el estrechamiento fue hecho con la guardia de tipo <a href=\"https://www.typescriptlang.org/docs/handbook/2/narrowing.html#instanceof-narrowing\">instanceof</a>, que es tan solo una de las muchas formas en las que se puede estrechar a un tipo. Vamos a ver muchas otras más adelante en esta parte.</p>\n<h3>Accediendo a argumentos de la linea de comandos</h3>\n<p>Los programas que hemos escrito están bien, pero seguro que sería mejor si pudiéramos usar argumentos de línea de comandos en lugar de tener que cambiar siempre el código para calcular cosas diferentes.</p>\n<p>Vamos a probar, como lo haríamos en una aplicación normal de Node, accediendo a <em>process.argv</em>. Si estas utilizando una versión de npm reciente (7.0 o superior), no habrá problemas, pero con una versión mas antigua algo no va bien:</p>\n<picture><img src=\"/static/07d7898a48d092c789aa57608097678f/5a190/5.png\" alt=\"error de vs code no puede encontrar nombre del proceso necesita instalar definiciones de tipo\" srcset=\"/static/07d7898a48d092c789aa57608097678f/772e8/5.png 200w,\n/static/07d7898a48d092c789aa57608097678f/e17e5/5.png 400w,\n/static/07d7898a48d092c789aa57608097678f/5a190/5.png 800w,\n/static/07d7898a48d092c789aa57608097678f/9d76a/5.png 829w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Entonces, ¿cual es el problema con las versiones antiguas?</p>\n<h3>@types/{npm_package}</h3>\n<p>Volvamos a la idea básica de TypeScript. TypeScript espera que todo el código utilizado globalmente sea tipado, como lo hace por tu código cuando tu proyecto tiene una configuración razonable. La biblioteca de TypeScript en sí misma, contiene solo tipados para el código del paquete TypeScript. Es posible escribir tus propias tipificaciones para el código de una libreria, pero eso casi nunca es necesario, ¡ya que la comunidad de TypeScript lo ha hecho por nosotros!</p>\n<p>Al igual que con npm, el mundo TypeScript también celebra el código fuente abierto. La comunidad está activa y reacciona continuamente a las actualizaciones y cambios en los paquetes npm de uso común. Casi siempre puedes encontrar las tipificaciones de paquetes npm, por lo que no tienes que crear tipificaciones para todas tus miles de dependencias por ti mismo.</p>\n<p>Por lo general, las tipificaciones de paquetes existentes se pueden encontrar en la organización <em>@types</em> dentro de npm, y puedes agregar los tipos relevantes a tu proyecto instalando un paquete npm con el nombre de tu paquete con el prefijo <em>@types/</em>. Por ejemplo:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev @types/react @types/express @types/lodash @types/jest @types/mongoose</code></pre></div>\n<p>y así sucesivamente. Los *@types/** son mantenidos por <a href=\"https://github.com/DefinitelyTyped/DefinitelyTyped\">Definitely typed</a>, un proyecto comunitario con el objetivo de mantener todas las tipificaciones en un solo lugar.</p>\n<p>A veces, un paquete npm también puede incluir sus tipificaciones dentro del código y, en ese caso, no es necesario instalar los correspondientes *@types/**.</p>\n<blockquote>\n<p><strong>NB:</strong> Dado que las tipificaciones solo se usan antes de la compilación, estas no son necesarias en la compilación de producción y siempre deben estar en devDependencies del package.json.</p>\n</blockquote>\n<p>Dado que la variable global <em>process</em> está definida por el propio Node, obtenemos sus tipificaciones del paquete <em>@types/node</em>.</p>\n<p>Desde la version 10.0 <em>ts-node</em> ha definido <em>@types/node</em> como una <a href=\"https://docs.npmjs.com/cli/v8/configuring-npm/package-json#peerdependencies\">dependencia entre pares</a>. Si la version de npm es al menos 7.0, las dependencias entre pares de un proyecto son automáticamente instaladas por npm. Si tienes una version mas antigua de npm, la dependencia entre pares debe ser instalada explícitamente:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev @types/node</code></pre></div>\n<p>Después de instalar el paquete @types/node, nuestro compilador ya no se queja de la variable <em>process</em>. Ten en cuenta que no es necesario requerir los tipos para el código, ¡la instalación del paquete es suficiente!</p>\n<h2>Mejorando el proyecto</h2>\n<p>A continuación, agreguemos scripts npm para ejecutar nuestros dos programas, <em>multiplier</em> y <em>calculator</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"fs-open\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0.0\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"main\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"index.ts\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"ts-node\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ts-node\"</span><span class=\"token punctuation\">,</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token property\">\"multiply\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ts-node multiplier.ts\"</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token property\">\"calculate\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ts-node calculator.ts\"</span></span>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"author\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"license\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ISC\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"devDependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"ts-node\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^10.5.0\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"typescript\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^4.5.5\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Podemos hacer que multiplier funcione con los parámetros de la línea de comando con los siguientes cambios</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">multiplicator</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">a</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">b</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">printText</span><span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>printText<span class=\"token punctuation\">,</span>  a <span class=\"token operator\">*</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token literal-property property\">a</span><span class=\"token operator\">:</span> number <span class=\"token operator\">=</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token literal-property property\">b</span><span class=\"token operator\">:</span> number <span class=\"token operator\">=</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">multiplicator</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Multiplied </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>a<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> and </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>b<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, the result is:</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Y podemos ejecutarlo con:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> run multiply <span class=\"token number\">5</span> <span class=\"token number\">2</span></code></pre></div>\n<p>Si el programa se ejecuta con parámetros que no son del tipo correcto, p. ej.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> run multiply <span class=\"token number\">5</span> lol</code></pre></div>\n<p>\"funciona\" pero nos da la respuesta</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">Multiplied <span class=\"token number\">5</span> and NaN, the result is: NaN</code></pre></div>\n<p>La razón de esto es que <em>Number('lol')</em> devuelve <em>NaN</em>, que en realidad es de tipo <em>number</em>, por lo que TypeScript no tiene poder para rescatarnos de este tipo de situación.</p>\n<p>Para evitar este tipo de comportamientos, tenemos que validar los datos que nos brindan desde la línea de comandos.</p>\n<p>La versión mejorada del multiplicador se ve así:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">MultiplyValues</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">value1</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n  <span class=\"token literal-property property\">value2</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> parseArguments <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>args<span class=\"token operator\">:</span> string<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token parameter\">MultiplyValues</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">.</span>length <span class=\"token operator\">&lt;</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Not enough arguments'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Too many arguments'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span><span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span><span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">value1</span><span class=\"token operator\">:</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">value2</span><span class=\"token operator\">:</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Provided values were not numbers!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">multiplicator</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">a</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">b</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">printText</span><span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>printText<span class=\"token punctuation\">,</span>  a <span class=\"token operator\">*</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> value1<span class=\"token punctuation\">,</span> value2 <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">parseArguments</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">multiplicator</span><span class=\"token punctuation\">(</span>value1<span class=\"token punctuation\">,</span> value2<span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Multiplied </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>value1<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> and </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>value2<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, the result is:</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token operator\">:</span> unknown<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> errorMessage <span class=\"token operator\">=</span> <span class=\"token string\">'Something bad happened.'</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    errorMessage <span class=\"token operator\">+=</span> <span class=\"token string\">' Error: '</span> <span class=\"token operator\">+</span> error<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>errorMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Cuando ahora ejecutamos el programa</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> run multiply <span class=\"token number\">1</span> lol</code></pre></div>\n<p>obtenemos un mensaje de error adecuado:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">Something bad happened. Error: Provided values were not numbers<span class=\"token operator\">!</span></code></pre></div>\n<p>Hay bastante sucediendo en el código. La adición más importante es la función <em>parseArguments</em> que se asegura de que los parámetros dados a <em>multiplicator</em> sean del tipo correcto. En caso contrario, se lanza una excepción con un mensaje de error descriptivo.</p>\n<p>La definición de la función tiene un par de cosas interesantes:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> parseArguments <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>args<span class=\"token operator\">:</span> string<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token parameter\">MultiplyValues</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>En primer lugar, el parámetro <em>args</em> es un <a href=\"https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#arrays\">array</a> de strings.</p>\n<p>El valor de retorno de la función tiene el tipo <em>MultiplyValues</em>, que se define de la siguiente manera:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">MultiplyValues</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">value1</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n  <span class=\"token literal-property property\">value2</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>La definición utiliza la palabra clave <a href=\"https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#interfaces\">Interface</a> de TypeScript, que es una forma de definir la \"forma\" que debe tener un objeto. En nuestro caso, es bastante obvio que el valor de retorno debe ser un objeto con dos propiedades <em>value1</em> y <em>value2</em>, que deben ser ambas del tipo number.</p>\n<h3>La sintaxis alternativa para arrays</h3>\n<p>Ten en cuenta que también existe una sintaxis alternativa para <a href=\"https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#arrays\">arrays</a> en TypeScript. En lugar de escribir</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">let</span> <span class=\"token literal-property property\">values</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>podríamos usar la \"sintaxis de genéricos\" y escribir</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">let</span> <span class=\"token literal-property property\">values</span><span class=\"token operator\">:</span> Array<span class=\"token operator\">&lt;</span>number<span class=\"token operator\">></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>En este curso, normalmente, seguiremos la convención impuesta por la regla de ESlint <a href=\"https://typescript-eslint.io/rules/array-type/#array-simple\">array-simple</a> que sugiere escribir los arrays simples con la sintaxis [] y usar la sintaxis &#x3C;> para los más complejos, mira los ejemplos <a href=\"https://typescript-eslint.io/rules/array-type/#array-simple\">aquí</a>.</p>\n</div>\n<div class=\"tasks\">\n<h3>Ejercicios 9.1.-9.3.</h3>\n<h4>setup</h4>\n<p>Los ejercicios 9.1.-9.7. se realizarán todos en el mismo proyecto de node. Crea el proyecto en un directorio vacío con <em>npm init</em> e instale los paquetes ts-node y typescript. Cree también el archivo <em>tsconfig.json</em> en el directorio con el siguiente contenido:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"noImplicitAny\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>La opción del compilador <a href=\"https://www.typescriptlang.org/tsconfig#noImplicitAny\">noImplicitAny</a>, que hace que sea obligatorio tener tipos para todas las variables utilizadas.</p>\n<h4>9.1 Índice de masa corporal</h4>\n<p>Crea el código de este ejercicio en el archivo <em>bmiCalculator.ts</em></p>\n<p>Escribe una función <em>calculateBmi</em> que cuente el <a href=\"https://es.wikipedia.org/wiki/%C3%8Dndice_de_masa_corporal\">IMC</a> según la altura (en centímetros) y el peso (en kilogramos) y que luego devuelva un mensaje que se adapte a los resultados.</p>\n<p>Llama a la función en el mismo archivo con parámetros fijos e imprime el resultado. El código</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">calculateBmi</span><span class=\"token punctuation\">(</span><span class=\"token number\">180</span><span class=\"token punctuation\">,</span> <span class=\"token number\">74</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>debe imprimir el siguiente mensaje</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">Normal <span class=\"token punctuation\">(</span>healthy weight<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Crea un script npm para ejecutar el programa con el comando <em>npm run calculateBmi</em></p>\n<h4>9.2 Calculadora de ejercicio</h4>\n<p>Crea el código de este ejercicio en el archivo <em>exerciseCalculator.ts</em></p>\n<p>Escribe una función <em>calculateExercises</em> que calcule el tiempo promedio de las <em>horas diarias de ejercicio</em> y lo compare con la <em>cantidad objetivo</em> de horas diarias y devuelva un objeto que incluya los siguientes valores:</p>\n<ul>\n<li>el número de días</li>\n<li>el número de días de entrenamiento</li>\n<li>el valor objetivo original</li>\n<li>el tiempo promedio calculado</li>\n<li>valor booleano que describe si se alcanzó el objetivo</li>\n<li>una calificación entre los números 1-3 que indica qué tan bien se cumplen las horas. Puedes decidir la métrica por tu cuenta.</li>\n<li>un valor de texto que explique la calificación, puedes inventar las explicaciones</li>\n</ul>\n<p>Las horas de ejercicio diarias se asignan a la función como un <a href=\"https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#arrays\">array</a> que contiene el número de horas de ejercicio de cada día en el período de entrenamiento. P.ej. una semana con 3 horas de entrenamiento el lunes, ninguna el martes, 2 horas el miércoles, 4,5 horas el jueves y así sucesivamente estaría representada por el siguiente array:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4.5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>Para el objeto Result, debe crear un <a href=\"https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#interfaces\">interface</a>.</p>\n<p>Si llamas a la función con los parámetros <em>[3, 0, 2, 4.5, 0, 3, 1]</em> y <em>2</em> , debería devolver:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">periodLength</span><span class=\"token operator\">:</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">trainingDays</span><span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">success</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">rating</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">ratingDescription</span><span class=\"token operator\">:</span> <span class=\"token string\">'not too bad but could be better'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">target</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">average</span><span class=\"token operator\">:</span> <span class=\"token number\">1.9285714285714286</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Crea un script npm <em>npm run calculateExercises</em> para llamar a la función con valores fijos.</p>\n<h4>9.3 Línea de comando</h4>\n<p>Cambia los ejercicios anteriores para que puedas dar los parámetros de <em>bmiCalculator</em> y <em>exerciseCalculator</em> como argumentos de línea de comando.</p>\n<p>Tu programa podría funcionar, por ejemplo. de la siguiente manera:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">npm</span> run calculateBmi <span class=\"token number\">180</span> <span class=\"token number\">91</span>\n\nOverweight</code></pre></div>\n<p>y:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">npm</span> run calculateExercises <span class=\"token number\">2</span> <span class=\"token number\">1</span> <span class=\"token number\">0</span> <span class=\"token number\">2</span> <span class=\"token number\">4.5</span> <span class=\"token number\">0</span> <span class=\"token number\">3</span> <span class=\"token number\">1</span> <span class=\"token number\">0</span> <span class=\"token number\">4</span>\n\n<span class=\"token punctuation\">{</span> periodLength: <span class=\"token number\">9</span>,\n  trainingDays: <span class=\"token number\">6</span>,\n  success: false,\n  rating: <span class=\"token number\">2</span>,\n  ratingDescription: <span class=\"token string\">'not too bad but could be better'</span>,\n  target: <span class=\"token number\">2</span>,\n  average: <span class=\"token number\">1.7222222222222223</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>En el ejemplo, el <em>primer argumento</em> es el valor objetivo.</p>\n<p>Maneja las excepciones y los errores de manera adecuada. exerciseCalculator debe aceptar entradas de diferentes longitudes. Determina tú mismo cómo recopilar toda la información necesaria.</p>\n<p>Un par de cosas para tener en cuenta:</p>\n<p>Si defines las funciones en otros módulos, deberías utilizar el <a href=\"https://developer.mozilla.org/es/docs/Web/JavaScript/Guide/Modules\">Sistema de módulos de Javascript</a>, el cual, es el mismo que hemos utilizado con React cuando la importación es realizada con</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> isNotNumber <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./utils\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>y la exportación</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> isNotNumber <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>argument<span class=\"token operator\">:</span> any<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token parameter\">boolean</span> <span class=\"token operator\">=></span>\n  <span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span><span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>argument<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">default</span> <span class=\"token keyword\">export</span> <span class=\"token string\">\"this is the default...\"</span></code></pre></div>\n<p>Otra nota: sorprendentemente, por algún motivo TypeScript no permite definir la misma variable en muchos archivos en el \"scope de bloque\", o sea, fuera de funciones (o clases):</p>\n<picture><img src=\"/static/8081b087125b7b34399577016b73499b/5a190/60new.png\" alt=\"vs code mostrando error no se puede re-declarar block-scoped variable x\" srcset=\"/static/8081b087125b7b34399577016b73499b/772e8/60new.png 200w,\n/static/8081b087125b7b34399577016b73499b/e17e5/60new.png 400w,\n/static/8081b087125b7b34399577016b73499b/5a190/60new.png 800w,\n/static/8081b087125b7b34399577016b73499b/c1b63/60new.png 1200w,\n/static/8081b087125b7b34399577016b73499b/29007/60new.png 1600w,\n/static/8081b087125b7b34399577016b73499b/d3deb/60new.png 1758w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>En realidad esto no es del todo cierto. Esta regla solamente aplica a archivos que son tratados como \"scripts\". Un archivo es un script si no contiene ninguna declaración de exportación o importación. Si un archivo las posee, entonces el archivo es tratado como un <a href=\"https://www.typescriptlang.org/docs/handbook/modules.html\">modulo</a>, <em>y</em> las variables no son definidas en el scope de bloque.</p>\n</div>\n<div class=\"content\">\n<h3>Más acerca de tsconfig</h3>\n<p>Hasta ahora solo hemos utilizado una regla en tsconfig, <a href=\"https://www.typescriptlang.org/tsconfig#noImplicitAny\">noImplicitAny</a>. Es un buen lugar para comenzar, pero ahora es el momento de profundizar un poco más en el archivo de configuración.</p>\n<p>Como ya mencionamos, el archivo <a href=\"https://www.typescriptlang.org/docs/handbook/tsconfig-json.html\">tsconfig.json</a> contiene todas tus configuraciones principales sobre cómo deseas que TypeScript funcione en tu proyecto.</p>\n<p>Especifiquemos las siguientes configuraciones en nuestro archivo <em>tsconfig.json</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ES2022\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"strict\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"noUnusedLocals\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"noUnusedParameters\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"noImplicitReturns\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"noFallthroughCasesInSwitch\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token property\">\"noImplicitAny\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span>    <span class=\"token property\">\"esModuleInterop\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"moduleResolution\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>No te preocupes demasiado por las <em>compilerOptions</em>, haremos una inspección minuciosa más adelante.</p>\n<p>Puedes encontrar explicaciones para cada una de las configuraciones en la documentación de TypeScript, o en la muy util <a href=\"https://www.typescriptlang.org/tsconfig\">página de tsconfig</a>, o en la <a href=\"http://json.schemastore.org/tsconfig\">definición del esquema</a> de tsconfig , que desafortunadamente tiene un formato un poco peor que las dos primeras opciones.</p>\n<h3>Añadiendo express a la mezcla</h3>\n<p>Ahora mismo estamos en un lugar bastante bueno. Nuestro proyecto está configurado y tenemos dos calculadoras ejecutables en él.\nSin embargo, dado que nuestro objetivo es aprender a desarrollar FullStack, es hora de empezar a trabajar con algunas solicitudes HTTP.</p>\n<p>Comencemos por instalar express:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> express</code></pre></div>\n<p>y luego agrega el script <em>start</em> a package.json:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ..</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"ts-node\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ts-node\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"multiply\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ts-node multiplier.ts\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"calculate\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ts-node calculator.ts\"</span><span class=\"token punctuation\">,</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token property\">\"start\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ts-node index.ts\"</span></span>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ..</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Ahora podemos crear el archivo <em>index.ts</em> y escribir el endpoint <em>ping</em> de HTTP GET:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'express'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/ping'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">PORT</span> <span class=\"token operator\">=</span> <span class=\"token number\">3003</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PORT</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Server running on port </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">PORT</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Todo lo demás parece estar funcionando bien, pero como era de esperar, los parámetros <em>req</em> y <em>res</em> de <em>app.get</em> necesitan tipado. Si observas con atención, VSCode también se queja acerca de la importación de Express. Puedes ver una pequeña línea amarilla de puntos debajo de <em>require</em>. Pasemos el cursor sobre el problema:</p>\n<picture><img src=\"/static/6aaed1ead88e0c5c5cf0bb2be6ab794e/0786c/6.png\" alt=\"vscode alertando sobre cambiar require a import\" srcset=\"/static/6aaed1ead88e0c5c5cf0bb2be6ab794e/772e8/6.png 200w,\n/static/6aaed1ead88e0c5c5cf0bb2be6ab794e/e17e5/6.png 400w,\n/static/6aaed1ead88e0c5c5cf0bb2be6ab794e/0786c/6.png 663w\" sizes=\"(max-width: 663px) 100vw, 663px\"></picture>\n<p>La queja es que la llamada <em>'require' puede convertirse en un import</em>. Sigamos los consejos y escribamos el import de la siguiente manera:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> express <span class=\"token keyword\">from</span> <span class=\"token string\">'express'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>NB</strong>: VSCode te ofrece una posibilidad para solucionar los problemas de forma automática haciendo clic en el botón <em>Quick fix...</em>. Mantén los ojos abiertos para estas ayudas/soluciones rápidas; escuchar a su editor generalmente hace que su código sea mejor y más fácil de leer. Las correcciones automáticas de problemas también pueden suponer un gran ahorro de tiempo.</p>\n<p>Ahora nos encontramos con otro problema: el compilador se queja de la declaración de importación.\nUna vez más, el editor es nuestro mejor amigo cuando tratamos de averiguar cuál es el problema:</p>\n<picture><img src=\"/static/42c8ddc465ac50724204530330e17888/5a190/7.png\" alt=\"error de vscode acerca de no encontrar express\" srcset=\"/static/42c8ddc465ac50724204530330e17888/772e8/7.png 200w,\n/static/42c8ddc465ac50724204530330e17888/e17e5/7.png 400w,\n/static/42c8ddc465ac50724204530330e17888/5a190/7.png 800w,\n/static/42c8ddc465ac50724204530330e17888/0eb6d/7.png 913w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>No hemos instalado tipos para <em>express</em>.\nHagamos lo que dice la sugerencia y ejecutemos:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev @types/express</code></pre></div>\n<p>¡Y no más errores! Echemos un vistazo a lo que cambió.</p>\n<p>Cuando pasamos el cursor sobre la declaración <em>require</em>, podemos ver que el compilador interpreta todo lo relacionado con express para que sea del tipo <em>any</em>.</p>\n<picture><img src=\"/static/1cd92a8bd9863c3ce7156427741c4e93/5a190/8a.png\" alt=\"vscode mostrando problema de tener un tipo any implícito\" srcset=\"/static/1cd92a8bd9863c3ce7156427741c4e93/772e8/8a.png 200w,\n/static/1cd92a8bd9863c3ce7156427741c4e93/e17e5/8a.png 400w,\n/static/1cd92a8bd9863c3ce7156427741c4e93/5a190/8a.png 800w,\n/static/1cd92a8bd9863c3ce7156427741c4e93/c1b63/8a.png 1200w,\n/static/1cd92a8bd9863c3ce7156427741c4e93/29007/8a.png 1600w,\n/static/1cd92a8bd9863c3ce7156427741c4e93/5fada/8a.png 1706w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Mientras que cuando usamos <em>import</em>, el editor conoce los tipos reales:</p>\n<picture><img src=\"/static/4a2694074c75032a45d3d8567cb56067/5a190/9x.png\" alt=\"vscode mostrando que req es de tipo Request\" srcset=\"/static/4a2694074c75032a45d3d8567cb56067/772e8/9x.png 200w,\n/static/4a2694074c75032a45d3d8567cb56067/e17e5/9x.png 400w,\n/static/4a2694074c75032a45d3d8567cb56067/5a190/9x.png 800w,\n/static/4a2694074c75032a45d3d8567cb56067/c1b63/9x.png 1200w,\n/static/4a2694074c75032a45d3d8567cb56067/add4c/9x.png 1452w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>La declaración de importación que se utilizará depende del método de exportación utilizado en el paquete importado.</p>\n<p>Una buena regla general es intentar importar un módulo utilizando primero la declaración <em>import</em>. Siempre usaremos este método en el <em>frontend</em>.\nSi <em>import</em> no funciona, prueba con un método combinado: <em>import ... = require('...')</em>.</p>\n<p>Te recomendamos encarecidamente que leas más sobre los módulos de TypeScript <a href=\"https://www.typescriptlang.org/docs/handbook/modules.html\">aquí</a>.</p>\n<p>Hay un problema más con el código.</p>\n<picture><img src=\"/static/b8b508be11f6f46ca98515ef7dcf11c0/5a190/9b.png\" alt=\"vscode mostrando req declarado pero nunca leído\" srcset=\"/static/b8b508be11f6f46ca98515ef7dcf11c0/772e8/9b.png 200w,\n/static/b8b508be11f6f46ca98515ef7dcf11c0/e17e5/9b.png 400w,\n/static/b8b508be11f6f46ca98515ef7dcf11c0/5a190/9b.png 800w,\n/static/b8b508be11f6f46ca98515ef7dcf11c0/c1b63/9b.png 1200w,\n/static/b8b508be11f6f46ca98515ef7dcf11c0/29007/9b.png 1600w,\n/static/b8b508be11f6f46ca98515ef7dcf11c0/1d499/9b.png 1632w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Esto se debe a que prohibimos los parámetros no utilizados en nuestro <em>tsconfig.json</em></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string-property property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ES2022\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"strict\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"noUnusedLocals\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token string-property property\">\"noUnusedParameters\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span>    <span class=\"token string-property property\">\"noImplicitReturns\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"noFallthroughCasesInSwitch\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"noImplicitAny\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"esModuleInterop\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"moduleResolution\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Esta configuración puede crear problemas si tienes funciones predefinidas en la librería que requieran declarar una variable incluso si no se usa en absoluto, como es el caso aquí.\nAfortunadamente, este problema ya se ha resuelto a nivel de configuración.\nUna vez más, pasar el cursor sobre el problema nos da una solución. Esta vez podemos hacer clic en el botón quick fix:</p>\n<picture><img src=\"/static/1c9e9465bd26936e8e95df71cf69292f/5a190/14a.png\" alt=\"vscode quickfix para agregar guion bajo a la variable\" srcset=\"/static/1c9e9465bd26936e8e95df71cf69292f/772e8/14a.png 200w,\n/static/1c9e9465bd26936e8e95df71cf69292f/e17e5/14a.png 400w,\n/static/1c9e9465bd26936e8e95df71cf69292f/5a190/14a.png 800w,\n/static/1c9e9465bd26936e8e95df71cf69292f/c1b63/14a.png 1200w,\n/static/1c9e9465bd26936e8e95df71cf69292f/29007/14a.png 1600w,\n/static/1c9e9465bd26936e8e95df71cf69292f/bf286/14a.png 1688w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Si es absolutamente imposible deshacerse de una variable no utilizada, puede pre-fijarla con un guion bajo para informar al compilador que ha pensado en ello y que no hay nada que pueda hacer.</p>\n<p>Cambiemos el nombre de la variable <em>req</em> a <em>_req</em>. Finalmente estamos listos para iniciar la aplicación. Parece que funciona bien:</p>\n<picture><img src=\"/static/0ce223dcd8032134d6854a274d4b8ef9/5a190/11a.png\" alt=\"navegador mostrando resultado pong en /ping\" srcset=\"/static/0ce223dcd8032134d6854a274d4b8ef9/772e8/11a.png 200w,\n/static/0ce223dcd8032134d6854a274d4b8ef9/e17e5/11a.png 400w,\n/static/0ce223dcd8032134d6854a274d4b8ef9/5a190/11a.png 800w,\n/static/0ce223dcd8032134d6854a274d4b8ef9/c1b63/11a.png 1200w,\n/static/0ce223dcd8032134d6854a274d4b8ef9/3ceac/11a.png 1456w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Para simplificar el desarrollo, deberíamos habilitar la <em>recarga automática</em> para mejorar nuestro flujo de trabajo. En este curso ya has utilizado <em>nodemon</em>, pero ts-node tiene una alternativa llamada <em>ts-node-dev</em>. Está hecho para ser utilizado solo en un entorno de desarrollo y se encarga de la re-compilación en cada cambio, por lo que no será necesario reiniciar la aplicación.</p>\n<p>Instalemos <em>ts-node-dev</em> en nuestras dependencias de desarrollo:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev ts-node-dev</code></pre></div>\n<p>Agreguemos un script a <em>package.json</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// ...</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token property\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ts-node-dev index.ts\"</span><span class=\"token punctuation\">,</span></span>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Y ahora, al ejecutar <em>npm run dev</em>, ¡tenemos un entorno de desarrollo que funciona y que se recarga automáticamente para nuestro proyecto!</p>\n</div>\n<div class=\"tasks\">\n<h3>Ejercicios 9.4.-9.5.</h3>\n<h4>9.4 Express</h4>\n<p>Agrega Express a tus dependencias y crea un endpoint HTTP GET <em>hello</em> que responda 'Hello Full Stack!'</p>\n<p>La aplicación web debe iniciarse con los comandos <em>npm start</em> en modo de producción y con <em>npm run dev</em> en modo de desarrollo, este último debe usar <em>ts-node-dev</em> para ejecutar la aplicación.</p>\n<p>Reemplaza también tu archivo <em>tsconfig.json</em> existente con el siguiente contenido:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"noImplicitAny\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"noImplicitReturns\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"strictNullChecks\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"strictPropertyInitialization\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"strictBindCallApply\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"noUnusedLocals\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"noUnusedParameters\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"noImplicitThis\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"alwaysStrict\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"esModuleInterop\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"declaration\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>¡Asegúrate de que no haya errores!</p>\n<h4>9.5 WebBMI</h4>\n<p>Agrega un endpoint para la calculadora de IMC que se pueda usar haciendo una solicitud HTTP GET al endpoint <em>bmi</em> y especificando el input con <a href=\"https://en.wikipedia.org/wiki/Query_string\">query string parameters</a>. Por ejemplo, para obtener el IMC de una persona que tiene una altura de 180 y un peso de 72, la URL es <a href=\"http://localhost:3002/bmi?height=180&#x26;weight=72\">http://localhost:3002/bmi?height=180&#x26;weight=72</a></p>\n<p>La respuesta es un json con este formato:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">weight</span><span class=\"token operator\">:</span> <span class=\"token number\">72</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token number\">180</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">bmi</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Normal (healthy weight)\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Consulta la <a href=\"http://expressjs.com/en/5x/api.html#req.query\">documentación de Express</a> para obtener información sobre cómo acceder a los parámetros de consulta.</p>\n<p>Si los parámetros de consulta de la solicitud son del tipo incorrecto o faltan, se proporciona una respuesta con el código de estado y el mensaje de error adecuados:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">error</span><span class=\"token operator\">:</span> <span class=\"token string\">\"malformatted parameters\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>No copies el código de la calculadora en el archivo <em>index.ts</em>, conviértelo en un <a href=\"https://www.typescriptlang.org/docs/handbook/modules.html\">módulo de Typescript</a> que se pueda importar en <em>index.ts</em>.</p>\n</div>\n<div class=\"content\">\n<h3>Los horrrores de <em>any</em></h3>\n<p>Ahora que hemos completado nuestros primeros endpoints, es posible que observes que apenas hemos usado TypeScript en estos pequeños ejemplos. Al examinar el código un poco más de cerca, podemos ver algunos peligros acechándonos.</p>\n<p>Agreguemos un endpoint HTTP POST <em>calculate</em> a nuestra aplicación:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> calculator <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./calculator'</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// ...</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/calculate'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> value1<span class=\"token punctuation\">,</span> value2<span class=\"token punctuation\">,</span> op <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token function\">calculator</span><span class=\"token punctuation\">(</span>value1<span class=\"token punctuation\">,</span> value2<span class=\"token punctuation\">,</span> op<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> result <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Para que esto funcione, debemos agregar un <em>export</em> a la función <em>calculator</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> calculator <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a<span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">b</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">op</span><span class=\"token operator\">:</span> Operation<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token parameter\">number</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></code></pre></div>\n<p>Cuando pasa el cursor sobre la función <em>calculate</em>, puede ver el tipeado de <em>calculator</em> aunque el código en sí no contiene ningún typing:</p>\n<picture><img src=\"/static/9a5513026b6fe6ab06a7c2dfdbfe3fae/5a190/12a21.png\" alt=\"vscode mostrando los tipos de calculator cuando el cursor esta sobre la función\" srcset=\"/static/9a5513026b6fe6ab06a7c2dfdbfe3fae/772e8/12a21.png 200w,\n/static/9a5513026b6fe6ab06a7c2dfdbfe3fae/e17e5/12a21.png 400w,\n/static/9a5513026b6fe6ab06a7c2dfdbfe3fae/5a190/12a21.png 800w,\n/static/9a5513026b6fe6ab06a7c2dfdbfe3fae/c1b63/12a21.png 1200w,\n/static/9a5513026b6fe6ab06a7c2dfdbfe3fae/29007/12a21.png 1600w,\n/static/9a5513026b6fe6ab06a7c2dfdbfe3fae/799f3/12a21.png 1642w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Pero si pasas el cursor sobre los valores del request, surge un problema:</p>\n<picture><img src=\"/static/8b80147c569dfdb6e4617fcc2f09c9f1/5a190/13a21.png\" alt=\"vscode problemáticamente mostrando any cuando el cursor esta sobre los argumentos de la función calculate\" srcset=\"/static/8b80147c569dfdb6e4617fcc2f09c9f1/772e8/13a21.png 200w,\n/static/8b80147c569dfdb6e4617fcc2f09c9f1/e17e5/13a21.png 400w,\n/static/8b80147c569dfdb6e4617fcc2f09c9f1/5a190/13a21.png 800w,\n/static/8b80147c569dfdb6e4617fcc2f09c9f1/c1b63/13a21.png 1200w,\n/static/8b80147c569dfdb6e4617fcc2f09c9f1/29007/13a21.png 1600w,\n/static/8b80147c569dfdb6e4617fcc2f09c9f1/966c1/13a21.png 1694w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Todas las variables tienen el tipo <em>any</em>. No es tan sorprendente, ya que nadie les ha dado un tipo todavía. Hay un par de maneras de solucionar este problema, pero primero, tenemos que considerar por qué esto es aceptado y de dónde viene el tipo <em>any</em>.</p>\n<p>En TypeScript, cada variable sin tipo cuyo tipo no se puede inferir, se convierte implícitamente en tipo <a href=\"https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#any\">any</a>. Any es una especie de tipo \"comodín\", que literalmente significa <em>cualquier</em> tipo.\nLas cosas se convierten implícitamente en tipo any con bastante frecuencia cuando uno se olvida de darle tipo a las funciones.</p>\n<p>También podemos explicitar el tipo <em>any</em>. La única diferencia entre tipo any implícito y explícito es en cómo se ve el código; al compilador no le importa la diferencia.</p>\n<p>Sin embargo, los programadores ven el código de manera diferente cuando se aplica <em>any</em> explícitamente que cuando se infiere implícitamente.\nEl <em>any</em> implícito generalmente se considera problemático, ya que a menudo se debe a que el desarrollador se olvido de asignar los tipos (o es demasiado perezoso para hacerlo), y también significa que no se aprovecha todo el poder de TypeScript.</p>\n<p>Es por esto que la regla de configuración <a href=\"https://www.typescriptlang.org/tsconfig#noImplicitAny\">noImplicitAny</a> existe a nivel de compilador, y es muy recomendable mantenerla activada en todo momento. En las raras ocasiones en las que no puedes saber cuál es el tipo de variable, debes indicarlo explícitamente en el código</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token literal-property property\">a</span> <span class=\"token operator\">:</span> any <span class=\"token operator\">=</span> <span class=\"token comment\">/* no clue what the type will be! */</span><span class=\"token punctuation\">.</span></code></pre></div>\n<p>Ya hemos configurado <em>noImplicitAny: true</em> en nuestro ejemplo, entonces, ¿por qué el compilador no se queja del tipo implícito <em>any</em>? La razón es que el campo <em>body</em> de un objeto <a href=\"https://expressjs.com/en/5x/api.html#req\">Request</a> de Express es explícitamente tipado como <em>any</em>. Lo mismo ocurre con el campo <em>request.query</em> que Express usa para los parámetros query.</p>\n<p>¿Y si quisiéramos evitar que los desarrolladores utilicen el tipo <em>any</em>? Afortunadamente, tenemos otros métodos además de <em>tsconfig.json</em> para hacer cumplir el estilo de codificación. Lo que podemos hacer es usar <em>ESlint</em> para administrar nuestro código.\nInstalemos ESlint y sus extensiones de Typescript:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev eslint @typescript-eslint/eslint-plugin @typescript-eslint/parser</code></pre></div>\n<p>Configuraremos ESlint para <a href=\"https://github.com/typescript-eslint/typescript-eslint/blob/main/packages/eslint-plugin/docs/rules/no-explicit-any.md\">no permitir any explicito</a>. Escribe las siguientes reglas en <em>.eslintrc</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"parser\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"@typescript-eslint/parser\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"parserOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"ecmaVersion\"</span><span class=\"token operator\">:</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"sourceType\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"module\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"plugins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"@typescript-eslint\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"rules\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"@typescript-eslint/no-explicit-any\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>(Nuevas versiones de ESlint tienen esta regla por defecto, no es realmente necesario que la añadas por separado.)</p>\n<p>Configuremos también un script <em>lint</em> npm para inspeccionar los archivos con la extensión <em>.ts</em>, modificando el archivo <em>package.json</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"start\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ts-node index.ts\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ts-node-dev index.ts\"</span><span class=\"token punctuation\">,</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token property\">\"lint\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"eslint --ext .ts .\"</span></span>      <span class=\"token comment\">//  ...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Ahora lint se quejará si intentamos definir una variable de tipo <em>any</em>:</p>\n<picture><img src=\"/static/b507fd23131ab2c569e987469a3f2265/5a190/13b.png\" alt=\"vscode mostrando ESlint quejándose acerca del uso del tipo any\" srcset=\"/static/b507fd23131ab2c569e987469a3f2265/772e8/13b.png 200w,\n/static/b507fd23131ab2c569e987469a3f2265/e17e5/13b.png 400w,\n/static/b507fd23131ab2c569e987469a3f2265/5a190/13b.png 800w,\n/static/b507fd23131ab2c569e987469a3f2265/c1b63/13b.png 1200w,\n/static/b507fd23131ab2c569e987469a3f2265/08c33/13b.png 1570w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p><a href=\"https://github.com/typescript-eslint/typescript-eslint\">@typescript-eslint</a> tiene un montón de reglas específicas ESlint para TypeScript, pero también puedes utilizar todas las reglas básicas de ESlint en proyectos de TypeScript.\nPor ahora, probablemente deberíamos ir con la configuración recomendada, y modificaremos las reglas a medida que avanzamos cada vez que encontremos algo que queremos que se comporte de manera diferente.</p>\n<p>Además de la configuración recomendada, deberíamos intentar familiarizarnos con el estilo de codificación requerido en esta parte y <em>ubicar el punto y coma al final de cada línea de código como requerido</em>.</p>\n<p>Entonces usaremos el siguiente <em>.eslintrc</em></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"extends\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"eslint:recommended\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"plugin:@typescript-eslint/recommended\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"plugin:@typescript-eslint/recommended-requiring-type-checking\"</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"plugins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"@typescript-eslint\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"env\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"node\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"es6\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"rules\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"@typescript-eslint/semi\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"error\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"@typescript-eslint/explicit-function-return-type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"off\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"@typescript-eslint/explicit-module-boundary-types\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"off\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"@typescript-eslint/restrict-template-expressions\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"off\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"@typescript-eslint/restrict-plus-operands\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"off\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"@typescript-eslint/no-unused-vars\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span> <span class=\"token property\">\"argsIgnorePattern\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^_\"</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"no-case-declarations\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"off\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"parser\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"@typescript-eslint/parser\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"parserOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"project\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./tsconfig.json\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Faltan algunos puntos y comas, pero son fáciles de agregar. También tenemos que arreglar problemas de ESlint acerca del tipo <em>any</em>:</p>\n<picture><img src=\"/static/9c13126ba452242ccd3ffd0896dc91ae/5a190/50x.png\" alt=\"error de vscode: asignación insegura de valor any\" srcset=\"/static/9c13126ba452242ccd3ffd0896dc91ae/772e8/50x.png 200w,\n/static/9c13126ba452242ccd3ffd0896dc91ae/e17e5/50x.png 400w,\n/static/9c13126ba452242ccd3ffd0896dc91ae/5a190/50x.png 800w,\n/static/9c13126ba452242ccd3ffd0896dc91ae/c1b63/50x.png 1200w,\n/static/9c13126ba452242ccd3ffd0896dc91ae/29007/50x.png 1600w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Podríamos y probablemente deberíamos deshabilitar algunas reglas de ESlint para obtener datos del request body.</p>\n<p>Deshabilitando <em>@typescript-eslint/no-unsafe-assignment</em> para la asignación de desestructuración y llamando al constructor <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/Number\">Number</a> a los valores casi que es suficiente:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">app<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/calculate'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// eslint-disable-next-line @typescript-eslint/no-unsafe-assignment</span></span>  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> value1<span class=\"token punctuation\">,</span> value2<span class=\"token punctuation\">,</span> op <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token function\">calculator</span><span class=\"token punctuation\">(</span><span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>value1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>value2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> op<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> result <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Sin embargo, esto aun nos deja con un problema con el que debemos lidiar, el último parámetro en la llamada a la función no es seguro:</p>\n<picture><img src=\"/static/9d5d14d86a2d319a55d71a7d65e279f3/5a190/51x.png\" alt=\"vscode mostrando argumento no seguro de tipo any asignado a párametro de tipo Operation\" srcset=\"/static/9d5d14d86a2d319a55d71a7d65e279f3/772e8/51x.png 200w,\n/static/9d5d14d86a2d319a55d71a7d65e279f3/e17e5/51x.png 400w,\n/static/9d5d14d86a2d319a55d71a7d65e279f3/5a190/51x.png 800w,\n/static/9d5d14d86a2d319a55d71a7d65e279f3/c1b63/51x.png 1200w,\n/static/9d5d14d86a2d319a55d71a7d65e279f3/29007/51x.png 1600w,\n/static/9d5d14d86a2d319a55d71a7d65e279f3/aaf7f/51x.png 1668w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Podemos deshabilitar otra regla de ESlint para deshacernos de ello:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">app<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/calculate'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// eslint-disable-next-line @typescript-eslint/no-unsafe-assignment</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> value1<span class=\"token punctuation\">,</span> value2<span class=\"token punctuation\">,</span> op <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// eslint-disable-next-line @typescript-eslint/no-unsafe-argument</span></span>  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token function\">calculator</span><span class=\"token punctuation\">(</span><span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>value1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>value2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> op<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> result <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Ahora tenemos a ESlint silenciado pero estamos completamente a la merced del usuario. Definitivamente debemos hacer alguna validación a los datos del post y dar un mensaje de error apropiado si los datos son invalidos:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">app<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/calculate'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// eslint-disable-next-line @typescript-eslint/no-unsafe-assignment</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> value1<span class=\"token punctuation\">,</span> value2<span class=\"token punctuation\">,</span> op <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token operator\">!</span>value1 <span class=\"token operator\">||</span> <span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span><span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>value1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">error</span><span class=\"token operator\">:</span> <span class=\"token string\">'...'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token comment\">// more validations here...</span>\n\n  <span class=\"token comment\">// eslint-disable-next-line @typescript-eslint/no-unsafe-argument</span>\n  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token function\">calculator</span><span class=\"token punctuation\">(</span><span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>value1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>value2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> op<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> result <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Veremos más tarde en esta parte algunas técnicas sobre como los datos de tipo <em>any</em> (por ejemplo, el input que una aplicación recibe del usuario) pueden ser <em>estrechados</em> a un tipo más especifico (como a un número). Con un estrechamiento de tipos apropiado, la necesidad de silenciar las reglas de ESlint desaparece.</p>\n<h3>Aserción de tipos</h3>\n<p>Utilizar una <a href=\"https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#type-assertions\">aserción de tipos</a> es otro \"truco sucio\" que puede hacerse para mantener al compilador de TypeScript y a ESlint en silencio. Exportemos el tipo Operation en <em>calculator.ts</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> type Operation <span class=\"token operator\">=</span> <span class=\"token string\">'multiply'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'add'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'divide'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Ahora podemos importar el tipo y usar una <em>aserción de tipo</em> para decirle al compilador de TypeScript cual es el tipo que una variable tiene:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> calculator<span class=\"token punctuation\">,</span> Operation <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./calculator'</span><span class=\"token punctuation\">;</span></span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/calculate'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// eslint-disable-next-line @typescript-eslint/no-unsafe-assignment</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> value1<span class=\"token punctuation\">,</span> value2<span class=\"token punctuation\">,</span> op <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// validate the data here</span>\n\n  <span class=\"token comment\">// assert the type</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> operation <span class=\"token operator\">=</span> op <span class=\"token keyword\">as</span> Operation<span class=\"token punctuation\">;</span></span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token function\">calculator</span><span class=\"token punctuation\">(</span><span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>value1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>value2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> operation<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> result <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>La constante definida como <em>operation</em> ahora tiene el tipo <em>Operation</em> y el compilador esta perfectamente feliz, no silenciar la regla de ESlint es necesario en el siguiente llamado a la función. La nueva variable ya no es necesaria, la aserción de tipo puede ser hecha cuando un argumento es pasado a la función:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">app<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/calculate'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// eslint-disable-next-line @typescript-eslint/no-unsafe-assignment</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> value1<span class=\"token punctuation\">,</span> value2<span class=\"token punctuation\">,</span> op <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// validate the data here</span>\n\n  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token function\">calculator</span><span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>value1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>value2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> op <span class=\"token keyword\">as</span> Operation</span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> result <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Utilizar una aserción de tipo (o silenciar una regla de ESlint) siempre es una cosa un poco arriesgada. Deja al compilador de TypeScript fuera de la escena, el compilador simplemente confía en que nosotros como desarrolladores sabemos lo que estamos haciendo. Si el tipo afirmado <em>no</em> tiene el valor correcto, el resultado puede ser un error en tiempo de ejecución, entonces debemos tener mucho cuidado cuando validamos los datos si una aserción de tipos es utilizada.</p>\n<p>En el próximo capitulo, le echaremos un vistazo al <a href=\"https://www.typescriptlang.org/docs/handbook/2/narrowing.html\">estrechamiento de tipos</a>, que nos proveerá de una forma mucho más segura de darle un tipo más estricto a los datos que provengan de una fuente externa.</p>\n</div>\n<div class=\"tasks\">\n<h3>Ejercicios 9.6.-9.7.</h3>\n<h4>9.6 ESlint</h4>\n<p>Configura tu proyecto para utilizar la configuración de ESlint que vimos en la parte anterior y corrige todas las advertencias.</p>\n<h4>9.7 WebExercises</h4>\n<p>Agrega un endpoint a tu aplicación para la calculadora de ejercicio. Debe usarse haciendo una solicitud HTTP POST al endpoint <a href=\"http://localhost:3002/exercises\">http://localhost:3002/exercises</a> con el siguiente input en el cuerpo de la solicitud:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">\"daily_exercises\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string-property property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2.5</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>La respuesta es un json con la siguiente forma:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n    <span class=\"token string-property property\">\"periodLength\"</span><span class=\"token operator\">:</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"trainingDays\"</span><span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"success\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"rating\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"ratingDescription\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"bad\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2.5</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"average\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1.2142857142857142</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Si el cuerpo de la solicitud no tiene el formato correcto, se da una respuesta con un código de estado y un mensaje de error adecuados. El mensaje de error es</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">error</span><span class=\"token operator\">:</span> <span class=\"token string\">\"parameters missing\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>o</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">error</span><span class=\"token operator\">:</span> <span class=\"token string\">\"malformatted parameters\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>dependiendo del error. Esto último ocurre si los valores de entrada no tienen el tipo correcto, por ejemplo, no son números ni se pueden convertir en números.</p>\n<p>En este ejercicio, puede que te resulte beneficioso utilizar el tipo <em>any explícito</em> cuando manejes los datos en el body de la solicitud. Nuestra configuración de ESlint evita esto, pero puedes deshabilitar esta regla para una línea en particular insertando el siguiente comentario como la línea anterior:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// eslint-disable-next-line @typescript-eslint/no-explicit-any</span></code></pre></div>\n<p>También podrías meterte en problemas con las reglas <em>no-unsafe-member-access</em> y <em>no-unsafe-assignment</em>. Estas reglas pueden ser ignoradas en este ejercicio.</p>\n<p>Ten en cuenta que debes tener una configuración correcta para poder acceder al cuerpo de la solicitud, consulta la <a href=\"/es/part3/node_js_y_express#recibiendo-informacion\">parte 3</a>.</p>\n</div>","frontmatter":{"mainImage":{"publicURL":"/static/ed8ae98c5d885b4d1928a681eefbe7c4/part-9.svg"},"part":9,"letter":"b","lang":"es"}}},"pageContext":{"part":9,"letter":"b","lang":"es"}},"staticQueryHashes":["3128451518"]}